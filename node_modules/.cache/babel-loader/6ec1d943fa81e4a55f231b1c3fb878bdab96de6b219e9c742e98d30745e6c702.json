{"ast":null,"code":"import { dropUndefinedKeys, logger } from '@sentry/utils';\nimport { DEBUG_BUILD } from '../debug-build.js';\nimport { getCurrentHub } from '../hub.js';\nimport { getMetricSummaryJsonForSpan } from '../metrics/metric-summary.js';\nimport { SEMANTIC_ATTRIBUTE_SENTRY_SOURCE, SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE } from '../semanticAttributes.js';\nimport { spanTimeInputToSeconds, spanToJSON, spanToTraceContext } from '../utils/spanUtils.js';\nimport { getDynamicSamplingContextFromSpan } from './dynamicSamplingContext.js';\nimport { Span, SpanRecorder } from './span.js';\nimport { getCapturedScopesOnSpan } from './trace.js';\n\n/** JSDoc */\nclass Transaction extends Span {\n  /**\n   * The reference to the current hub.\n   */\n\n  // DO NOT yet remove this property, it is used in a hack for v7 backwards compatibility.\n\n  /**\n   * This constructor should never be called manually. Those instrumenting tracing should use\n   * `Sentry.startTransaction()`, and internal methods should use `hub.startTransaction()`.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   *\n   * @deprecated Transactions will be removed in v8. Use spans instead.\n   */\n  constructor(transactionContext, hub) {\n    super(transactionContext);\n    this._contexts = {};\n\n    // eslint-disable-next-line deprecation/deprecation\n    this._hub = hub || getCurrentHub();\n    this._name = transactionContext.name || '';\n    this._metadata = {\n      // eslint-disable-next-line deprecation/deprecation\n      ...transactionContext.metadata\n    };\n    this._trimEnd = transactionContext.trimEnd;\n\n    // this is because transactions are also spans, and spans have a transaction pointer\n    // TODO (v8): Replace this with another way to set the root span\n    // eslint-disable-next-line deprecation/deprecation\n    this.transaction = this;\n\n    // If Dynamic Sampling Context is provided during the creation of the transaction, we freeze it as it usually means\n    // there is incoming Dynamic Sampling Context. (Either through an incoming request, a baggage meta-tag, or other means)\n    const incomingDynamicSamplingContext = this._metadata.dynamicSamplingContext;\n    if (incomingDynamicSamplingContext) {\n      // We shallow copy this in case anything writes to the original reference of the passed in `dynamicSamplingContext`\n      this._frozenDynamicSamplingContext = {\n        ...incomingDynamicSamplingContext\n      };\n    }\n  }\n\n  // This sadly conflicts with the getter/setter ordering :(\n  /* eslint-disable @typescript-eslint/member-ordering */\n\n  /**\n   * Getter for `name` property.\n   * @deprecated Use `spanToJSON(span).description` instead.\n   */\n  get name() {\n    return this._name;\n  }\n\n  /**\n   * Setter for `name` property, which also sets `source` as custom.\n   * @deprecated Use `updateName()` and `setMetadata()` instead.\n   */\n  set name(newName) {\n    // eslint-disable-next-line deprecation/deprecation\n    this.setName(newName);\n  }\n\n  /**\n   * Get the metadata for this transaction.\n   * @deprecated Use `spanGetMetadata(transaction)` instead.\n   */\n  get metadata() {\n    // We merge attributes in for backwards compatibility\n    return {\n      // Defaults\n      // eslint-disable-next-line deprecation/deprecation\n      source: 'custom',\n      spanMetadata: {},\n      // Legacy metadata\n      ...this._metadata,\n      // From attributes\n      ...(this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE] && {\n        source: this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]\n      }),\n      ...(this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE] && {\n        sampleRate: this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]\n      })\n    };\n  }\n\n  /**\n   * Update the metadata for this transaction.\n   * @deprecated Use `spanGetMetadata(transaction)` instead.\n   */\n  set metadata(metadata) {\n    this._metadata = metadata;\n  }\n\n  /* eslint-enable @typescript-eslint/member-ordering */\n\n  /**\n   * Setter for `name` property, which also sets `source` on the metadata.\n   *\n   * @deprecated Use `.updateName()` and `.setAttribute()` instead.\n   */\n  setName(name, source = 'custom') {\n    this._name = name;\n    this.setAttribute(SEMANTIC_ATTRIBUTE_SENTRY_SOURCE, source);\n  }\n\n  /** @inheritdoc */\n  updateName(name) {\n    this._name = name;\n    return this;\n  }\n\n  /**\n   * Attaches SpanRecorder to the span itself\n   * @param maxlen maximum number of spans that can be recorded\n   */\n  initSpanRecorder(maxlen = 1000) {\n    // eslint-disable-next-line deprecation/deprecation\n    if (!this.spanRecorder) {\n      // eslint-disable-next-line deprecation/deprecation\n      this.spanRecorder = new SpanRecorder(maxlen);\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Set the context of a transaction event.\n   * @deprecated Use either `.setAttribute()`, or set the context on the scope before creating the transaction.\n   */\n  setContext(key, context) {\n    if (context === null) {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this._contexts[key];\n    } else {\n      this._contexts[key] = context;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   *\n   * @deprecated Use top-level `setMeasurement()` instead.\n   */\n  setMeasurement(name, value, unit = '') {\n    this._measurements[name] = {\n      value,\n      unit\n    };\n  }\n\n  /**\n   * Store metadata on this transaction.\n   * @deprecated Use attributes or store data on the scope instead.\n   */\n  setMetadata(newMetadata) {\n    this._metadata = {\n      ...this._metadata,\n      ...newMetadata\n    };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  end(endTimestamp) {\n    const timestampInS = spanTimeInputToSeconds(endTimestamp);\n    const transaction = this._finishTransaction(timestampInS);\n    if (!transaction) {\n      return undefined;\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    return this._hub.captureEvent(transaction);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toContext() {\n    // eslint-disable-next-line deprecation/deprecation\n    const spanContext = super.toContext();\n    return dropUndefinedKeys({\n      ...spanContext,\n      name: this._name,\n      trimEnd: this._trimEnd\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateWithContext(transactionContext) {\n    // eslint-disable-next-line deprecation/deprecation\n    super.updateWithContext(transactionContext);\n    this._name = transactionContext.name || '';\n    this._trimEnd = transactionContext.trimEnd;\n    return this;\n  }\n\n  /**\n   * @inheritdoc\n   *\n   * @experimental\n   *\n   * @deprecated Use top-level `getDynamicSamplingContextFromSpan` instead.\n   */\n  getDynamicSamplingContext() {\n    return getDynamicSamplingContextFromSpan(this);\n  }\n\n  /**\n   * Override the current hub with a new one.\n   * Used if you want another hub to finish the transaction.\n   *\n   * @internal\n   */\n  setHub(hub) {\n    this._hub = hub;\n  }\n\n  /**\n   * Get the profile id of the transaction.\n   */\n  getProfileId() {\n    if (this._contexts !== undefined && this._contexts['profile'] !== undefined) {\n      return this._contexts['profile'].profile_id;\n    }\n    return undefined;\n  }\n\n  /**\n   * Finish the transaction & prepare the event to send to Sentry.\n   */\n  _finishTransaction(endTimestamp) {\n    // This transaction is already finished, so we should not flush it again.\n    if (this._endTime !== undefined) {\n      return undefined;\n    }\n    if (!this._name) {\n      DEBUG_BUILD && logger.warn('Transaction has no name, falling back to `<unlabeled transaction>`.');\n      this._name = '<unlabeled transaction>';\n    }\n\n    // just sets the end timestamp\n    super.end(endTimestamp);\n\n    // eslint-disable-next-line deprecation/deprecation\n    const client = this._hub.getClient();\n    if (client && client.emit) {\n      client.emit('finishTransaction', this);\n    }\n    if (this._sampled !== true) {\n      // At this point if `sampled !== true` we want to discard the transaction.\n      DEBUG_BUILD && logger.log('[Tracing] Discarding transaction because its trace was not chosen to be sampled.');\n      if (client) {\n        client.recordDroppedEvent('sample_rate', 'transaction');\n      }\n      return undefined;\n    }\n\n    // eslint-disable-next-line deprecation/deprecation\n    const finishedSpans = this.spanRecorder ?\n    // eslint-disable-next-line deprecation/deprecation\n    this.spanRecorder.spans.filter(span => span !== this && spanToJSON(span).timestamp) : [];\n    if (this._trimEnd && finishedSpans.length > 0) {\n      const endTimes = finishedSpans.map(span => spanToJSON(span).timestamp).filter(Boolean);\n      this._endTime = endTimes.reduce((prev, current) => {\n        return prev > current ? prev : current;\n      });\n    }\n    const {\n      scope: capturedSpanScope,\n      isolationScope: capturedSpanIsolationScope\n    } = getCapturedScopesOnSpan(this);\n\n    // eslint-disable-next-line deprecation/deprecation\n    const {\n      metadata\n    } = this;\n    // eslint-disable-next-line deprecation/deprecation\n    const {\n      source\n    } = metadata;\n    const transaction = {\n      contexts: {\n        ...this._contexts,\n        // We don't want to override trace context\n        trace: spanToTraceContext(this)\n      },\n      // TODO: Pass spans serialized via `spanToJSON()` here instead in v8.\n      spans: finishedSpans,\n      start_timestamp: this._startTime,\n      // eslint-disable-next-line deprecation/deprecation\n      tags: this.tags,\n      timestamp: this._endTime,\n      transaction: this._name,\n      type: 'transaction',\n      sdkProcessingMetadata: {\n        ...metadata,\n        capturedSpanScope,\n        capturedSpanIsolationScope,\n        ...dropUndefinedKeys({\n          dynamicSamplingContext: getDynamicSamplingContextFromSpan(this)\n        })\n      },\n      _metrics_summary: getMetricSummaryJsonForSpan(this),\n      ...(source && {\n        transaction_info: {\n          source\n        }\n      })\n    };\n    const hasMeasurements = Object.keys(this._measurements).length > 0;\n    if (hasMeasurements) {\n      DEBUG_BUILD && logger.log('[Measurements] Adding measurements to transaction', JSON.stringify(this._measurements, undefined, 2));\n      transaction.measurements = this._measurements;\n    }\n\n    // eslint-disable-next-line deprecation/deprecation\n    DEBUG_BUILD && logger.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`);\n    return transaction;\n  }\n}\nexport { Transaction };","map":{"version":3,"names":["Transaction","Span","constructor","transactionContext","hub","_contexts","_hub","getCurrentHub","_name","name","_metadata","metadata","_trimEnd","trimEnd","transaction","incomingDynamicSamplingContext","dynamicSamplingContext","_frozenDynamicSamplingContext","newName","setName","source","spanMetadata","_attributes","SEMANTIC_ATTRIBUTE_SENTRY_SOURCE","SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE","sampleRate","setAttribute","updateName","initSpanRecorder","maxlen","spanRecorder","SpanRecorder","add","setContext","key","context","setMeasurement","value","unit","_measurements","setMetadata","newMetadata","end","endTimestamp","timestampInS","spanTimeInputToSeconds","_finishTransaction","undefined","captureEvent","toContext","spanContext","dropUndefinedKeys","updateWithContext","getDynamicSamplingContext","getDynamicSamplingContextFromSpan","setHub","getProfileId","profile_id","_endTime","DEBUG_BUILD","logger","warn","client","getClient","emit","_sampled","log","recordDroppedEvent","finishedSpans","spans","filter","span","spanToJSON","timestamp","length","endTimes","map","Boolean","reduce","prev","current","scope","capturedSpanScope","isolationScope","capturedSpanIsolationScope","getCapturedScopesOnSpan","contexts","trace","spanToTraceContext","start_timestamp","_startTime","tags","type","sdkProcessingMetadata","_metrics_summary","getMetricSummaryJsonForSpan","transaction_info","hasMeasurements","Object","keys","JSON","stringify","measurements","op"],"sources":["/Users/amandawarnakula/ParkwayLabs/TestApplications/error_handling/node_modules/@sentry/src/tracing/transaction.ts"],"sourcesContent":["import type {\n  Context,\n  Contexts,\n  DynamicSamplingContext,\n  MeasurementUnit,\n  SpanTimeInput,\n  Transaction as TransactionInterface,\n  TransactionContext,\n  TransactionEvent,\n  TransactionMetadata,\n} from '@sentry/types';\nimport { dropUndefinedKeys, logger } from '@sentry/utils';\n\nimport { DEBUG_BUILD } from '../debug-build';\nimport type { Hub } from '../hub';\nimport { getCurrentHub } from '../hub';\nimport { getMetricSummaryJsonForSpan } from '../metrics/metric-summary';\nimport { SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE, SEMANTIC_ATTRIBUTE_SENTRY_SOURCE } from '../semanticAttributes';\nimport { spanTimeInputToSeconds, spanToJSON, spanToTraceContext } from '../utils/spanUtils';\nimport { getDynamicSamplingContextFromSpan } from './dynamicSamplingContext';\nimport { Span as SpanClass, SpanRecorder } from './span';\nimport { getCapturedScopesOnSpan } from './trace';\n\n/** JSDoc */\nexport class Transaction extends SpanClass implements TransactionInterface {\n  /**\n   * The reference to the current hub.\n   */\n  public _hub: Hub;\n\n  protected _name: string;\n\n  private _contexts: Contexts;\n\n  private _trimEnd?: boolean | undefined;\n\n  // DO NOT yet remove this property, it is used in a hack for v7 backwards compatibility.\n  private _frozenDynamicSamplingContext: Readonly<Partial<DynamicSamplingContext>> | undefined;\n\n  private _metadata: Partial<TransactionMetadata>;\n\n  /**\n   * This constructor should never be called manually. Those instrumenting tracing should use\n   * `Sentry.startTransaction()`, and internal methods should use `hub.startTransaction()`.\n   * @internal\n   * @hideconstructor\n   * @hidden\n   *\n   * @deprecated Transactions will be removed in v8. Use spans instead.\n   */\n  public constructor(transactionContext: TransactionContext, hub?: Hub) {\n    super(transactionContext);\n    this._contexts = {};\n\n    // eslint-disable-next-line deprecation/deprecation\n    this._hub = hub || getCurrentHub();\n\n    this._name = transactionContext.name || '';\n\n    this._metadata = {\n      // eslint-disable-next-line deprecation/deprecation\n      ...transactionContext.metadata,\n    };\n\n    this._trimEnd = transactionContext.trimEnd;\n\n    // this is because transactions are also spans, and spans have a transaction pointer\n    // TODO (v8): Replace this with another way to set the root span\n    // eslint-disable-next-line deprecation/deprecation\n    this.transaction = this;\n\n    // If Dynamic Sampling Context is provided during the creation of the transaction, we freeze it as it usually means\n    // there is incoming Dynamic Sampling Context. (Either through an incoming request, a baggage meta-tag, or other means)\n    const incomingDynamicSamplingContext = this._metadata.dynamicSamplingContext;\n    if (incomingDynamicSamplingContext) {\n      // We shallow copy this in case anything writes to the original reference of the passed in `dynamicSamplingContext`\n      this._frozenDynamicSamplingContext = { ...incomingDynamicSamplingContext };\n    }\n  }\n\n  // This sadly conflicts with the getter/setter ordering :(\n  /* eslint-disable @typescript-eslint/member-ordering */\n\n  /**\n   * Getter for `name` property.\n   * @deprecated Use `spanToJSON(span).description` instead.\n   */\n  public get name(): string {\n    return this._name;\n  }\n\n  /**\n   * Setter for `name` property, which also sets `source` as custom.\n   * @deprecated Use `updateName()` and `setMetadata()` instead.\n   */\n  public set name(newName: string) {\n    // eslint-disable-next-line deprecation/deprecation\n    this.setName(newName);\n  }\n\n  /**\n   * Get the metadata for this transaction.\n   * @deprecated Use `spanGetMetadata(transaction)` instead.\n   */\n  public get metadata(): TransactionMetadata {\n    // We merge attributes in for backwards compatibility\n    return {\n      // Defaults\n      // eslint-disable-next-line deprecation/deprecation\n      source: 'custom',\n      spanMetadata: {},\n\n      // Legacy metadata\n      ...this._metadata,\n\n      // From attributes\n      ...(this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE] && {\n        source: this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SOURCE] as TransactionMetadata['source'],\n      }),\n      ...(this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE] && {\n        sampleRate: this._attributes[SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE] as TransactionMetadata['sampleRate'],\n      }),\n    };\n  }\n\n  /**\n   * Update the metadata for this transaction.\n   * @deprecated Use `spanGetMetadata(transaction)` instead.\n   */\n  public set metadata(metadata: TransactionMetadata) {\n    this._metadata = metadata;\n  }\n\n  /* eslint-enable @typescript-eslint/member-ordering */\n\n  /**\n   * Setter for `name` property, which also sets `source` on the metadata.\n   *\n   * @deprecated Use `.updateName()` and `.setAttribute()` instead.\n   */\n  public setName(name: string, source: TransactionMetadata['source'] = 'custom'): void {\n    this._name = name;\n    this.setAttribute(SEMANTIC_ATTRIBUTE_SENTRY_SOURCE, source);\n  }\n\n  /** @inheritdoc */\n  public updateName(name: string): this {\n    this._name = name;\n    return this;\n  }\n\n  /**\n   * Attaches SpanRecorder to the span itself\n   * @param maxlen maximum number of spans that can be recorded\n   */\n  public initSpanRecorder(maxlen: number = 1000): void {\n    // eslint-disable-next-line deprecation/deprecation\n    if (!this.spanRecorder) {\n      // eslint-disable-next-line deprecation/deprecation\n      this.spanRecorder = new SpanRecorder(maxlen);\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    this.spanRecorder.add(this);\n  }\n\n  /**\n   * Set the context of a transaction event.\n   * @deprecated Use either `.setAttribute()`, or set the context on the scope before creating the transaction.\n   */\n  public setContext(key: string, context: Context | null): void {\n    if (context === null) {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete this._contexts[key];\n    } else {\n      this._contexts[key] = context;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   *\n   * @deprecated Use top-level `setMeasurement()` instead.\n   */\n  public setMeasurement(name: string, value: number, unit: MeasurementUnit = ''): void {\n    this._measurements[name] = { value, unit };\n  }\n\n  /**\n   * Store metadata on this transaction.\n   * @deprecated Use attributes or store data on the scope instead.\n   */\n  public setMetadata(newMetadata: Partial<TransactionMetadata>): void {\n    this._metadata = { ...this._metadata, ...newMetadata };\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public end(endTimestamp?: SpanTimeInput): string | undefined {\n    const timestampInS = spanTimeInputToSeconds(endTimestamp);\n    const transaction = this._finishTransaction(timestampInS);\n    if (!transaction) {\n      return undefined;\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    return this._hub.captureEvent(transaction);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public toContext(): TransactionContext {\n    // eslint-disable-next-line deprecation/deprecation\n    const spanContext = super.toContext();\n\n    return dropUndefinedKeys({\n      ...spanContext,\n      name: this._name,\n      trimEnd: this._trimEnd,\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public updateWithContext(transactionContext: TransactionContext): this {\n    // eslint-disable-next-line deprecation/deprecation\n    super.updateWithContext(transactionContext);\n\n    this._name = transactionContext.name || '';\n    this._trimEnd = transactionContext.trimEnd;\n\n    return this;\n  }\n\n  /**\n   * @inheritdoc\n   *\n   * @experimental\n   *\n   * @deprecated Use top-level `getDynamicSamplingContextFromSpan` instead.\n   */\n  public getDynamicSamplingContext(): Readonly<Partial<DynamicSamplingContext>> {\n    return getDynamicSamplingContextFromSpan(this);\n  }\n\n  /**\n   * Override the current hub with a new one.\n   * Used if you want another hub to finish the transaction.\n   *\n   * @internal\n   */\n  public setHub(hub: Hub): void {\n    this._hub = hub;\n  }\n\n  /**\n   * Get the profile id of the transaction.\n   */\n  public getProfileId(): string | undefined {\n    if (this._contexts !== undefined && this._contexts['profile'] !== undefined) {\n      return this._contexts['profile'].profile_id as string;\n    }\n    return undefined;\n  }\n\n  /**\n   * Finish the transaction & prepare the event to send to Sentry.\n   */\n  protected _finishTransaction(endTimestamp?: number): TransactionEvent | undefined {\n    // This transaction is already finished, so we should not flush it again.\n    if (this._endTime !== undefined) {\n      return undefined;\n    }\n\n    if (!this._name) {\n      DEBUG_BUILD && logger.warn('Transaction has no name, falling back to `<unlabeled transaction>`.');\n      this._name = '<unlabeled transaction>';\n    }\n\n    // just sets the end timestamp\n    super.end(endTimestamp);\n\n    // eslint-disable-next-line deprecation/deprecation\n    const client = this._hub.getClient();\n    if (client && client.emit) {\n      client.emit('finishTransaction', this);\n    }\n\n    if (this._sampled !== true) {\n      // At this point if `sampled !== true` we want to discard the transaction.\n      DEBUG_BUILD && logger.log('[Tracing] Discarding transaction because its trace was not chosen to be sampled.');\n\n      if (client) {\n        client.recordDroppedEvent('sample_rate', 'transaction');\n      }\n\n      return undefined;\n    }\n\n    // eslint-disable-next-line deprecation/deprecation\n    const finishedSpans = this.spanRecorder\n      ? // eslint-disable-next-line deprecation/deprecation\n        this.spanRecorder.spans.filter(span => span !== this && spanToJSON(span).timestamp)\n      : [];\n\n    if (this._trimEnd && finishedSpans.length > 0) {\n      const endTimes = finishedSpans.map(span => spanToJSON(span).timestamp).filter(Boolean) as number[];\n      this._endTime = endTimes.reduce((prev, current) => {\n        return prev > current ? prev : current;\n      });\n    }\n\n    const { scope: capturedSpanScope, isolationScope: capturedSpanIsolationScope } = getCapturedScopesOnSpan(this);\n\n    // eslint-disable-next-line deprecation/deprecation\n    const { metadata } = this;\n    // eslint-disable-next-line deprecation/deprecation\n    const { source } = metadata;\n\n    const transaction: TransactionEvent = {\n      contexts: {\n        ...this._contexts,\n        // We don't want to override trace context\n        trace: spanToTraceContext(this),\n      },\n      // TODO: Pass spans serialized via `spanToJSON()` here instead in v8.\n      spans: finishedSpans,\n      start_timestamp: this._startTime,\n      // eslint-disable-next-line deprecation/deprecation\n      tags: this.tags,\n      timestamp: this._endTime,\n      transaction: this._name,\n      type: 'transaction',\n      sdkProcessingMetadata: {\n        ...metadata,\n        capturedSpanScope,\n        capturedSpanIsolationScope,\n        ...dropUndefinedKeys({\n          dynamicSamplingContext: getDynamicSamplingContextFromSpan(this),\n        }),\n      },\n      _metrics_summary: getMetricSummaryJsonForSpan(this),\n      ...(source && {\n        transaction_info: {\n          source,\n        },\n      }),\n    };\n\n    const hasMeasurements = Object.keys(this._measurements).length > 0;\n\n    if (hasMeasurements) {\n      DEBUG_BUILD &&\n        logger.log(\n          '[Measurements] Adding measurements to transaction',\n          JSON.stringify(this._measurements, undefined, 2),\n        );\n      transaction.measurements = this._measurements;\n    }\n\n    // eslint-disable-next-line deprecation/deprecation\n    DEBUG_BUILD && logger.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`);\n\n    return transaction;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}